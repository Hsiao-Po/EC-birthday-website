<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>生日快樂！</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #e0f7fa 0%, #b3e5fc 100%);
      height: 100vh;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .scene {
      width: 800px;
      height: 600px;
      position: relative;
      background-color: #ffffff;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }
    
    .header {
      width: 100%;
      padding: 20px 0;
      text-align: center;
      background-color: #ff7043;
      color: white;
      font-size: 2.5rem;
      font-weight: bold;
      position: relative;
      z-index: 10;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .subheader {
      font-size: 1.5rem;
      margin-top: 5px;
    }
    
    .stage {
      position: relative;
      width: 100%;
      height: calc(100% - 90px);
      background: linear-gradient(to bottom, #bbdefb 0%, #ffffff 100%);
    }
    
    .character {
      position: absolute;
      cursor: pointer;
      transition: transform 0.3s ease;
      filter: drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.2));
    }
    
    .character:hover {
      transform: scale(1.1);
    }        
    .heart {
         position: absolute;
         color: red;
         font-size: 24px;
         pointer-events: none;
         animation: float 2s ease-out forwards;
         opacity: 0;
    }

    @keyframes float {
        0% {
            transform: translateY(0) scale(0.5);
            opacity: 0;
        }
        10% {
            opacity: 1;
        }
        100% {
            transform: translateY(-100px) scale(1.5);
            opacity: 0;
        }
    }


    /* 圓形相框樣式 */
    .character-frame {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      overflow: hidden;
      border: 3px solid white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      background-color: #f5f5f5;
    }
    
    .character img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    #basketball-boy {
      width: 120px;
      height: 120px;
      left: 50%;
      top: 40%;
      transform: translateX(-50%);
      z-index: 50;
    }
    
    #curly-girl {
      width: 110px;
      height: 110px;
      left: 30%;
      top: 45%;
      z-index: 40;
    }
    
    #teddy-bear {
      width: 90px;
      height: 90px;
      left: 65%;
      top: 55%;
      z-index: 30;
    }
    
    #otter {
      width: 80px;
      height: 80px;
      left: 20%;
      top: 60%;
      z-index: 20;
    }
    
    #golden-retriever {
      width: 100px;
      height: 100px;
      left: 75%;
      top: 58%;
      z-index: 15;
    }
    
    #british-cat {
      width: 70px;
      height: 70px;
      left: 85%;
      top: 65%;
      z-index: 10;
    }
    
    .cake {
      position: absolute;
      width: 120px;
      height: 120px;
      left: 50%;
      transform: translateX(-50%);
      bottom: 10%;
      cursor: pointer;
      z-index: 60;
    }
    
    .cake-frame {
      width: 100%;
      height: 100%;
      overflow: hidden;
      border-radius: 15px;
      border: 3px solid white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }
    
    .cake img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    
    .dialog {
      position: absolute;
      background-color: white;
      border-radius: 15px;
      padding: 10px 15px;
      max-width: 180px;
      min-width: 120px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      font-size: 14px;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s ease, transform 0.3s ease;
      text-align: center;
      z-index: 100;
      pointer-events: none;
    }
    
    .dialog:after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      border-width: 10px 10px 0;
      border-style: solid;
      border-color: white transparent transparent transparent;
    }
    
    .balloon {
      position: absolute;
      width: 100px;
      height: 130px;
      animation: float 5s infinite ease-in-out;
      z-index: 10;
    }
    
    .balloon-frame {
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    
    .balloon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }
    
    .photo-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
    }
    
    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 25px;
      border-radius: 15px;
      width: 80%;
      max-width: 800px;
      max-height: 85vh;
      overflow-y: auto;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }
    
    .modal-header h2 {
      color: #ff7043;
      font-size: 1.8rem;
    }
    
    .close-button {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.2s;
    }
    
    .close-button:hover {
      color: #555;
    }
    
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
    }
    
    /* 圓形相冊照片 */
    .photo {
      width: 100%;
      aspect-ratio: 1/1;
      background-color: #eee;
      border-radius: 50%;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s ease;
      border: 4px solid white;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
    }
    
    .photo:hover {
      transform: scale(1.05);
    }
    
    .photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .confetti {
      position: absolute;
      width: 12px;
      height: 12px;
      z-index: 5;
      pointer-events: none;
    }
    
    .message-board {
      position: absolute;
      bottom: 5px;
      width: 100%;
      text-align: center;
      color: #ff7043;
      font-size: 16px;
      font-weight: bold;
      z-index: 70;
    }
    
    .music-toggle {
      position: absolute;
      bottom: 15px;
      right: 15px;
      width: 40px;
      height: 40px;
      background-color: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      z-index: 80;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    
    .music-icon {
      width: 20px;
      height: 20px;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
    }
    
    /* 上傳照片說明 */
    .photo-instructions {
      margin: 10px 0 20px;
      color: #666;
      font-size: 14px;
      line-height: 1.5;
    }
  </style>
</head>
<body>
  <div class="scene">
    <div class="header">
      生日快樂！
      <div class="subheader">4月11日</div>
    </div>
    
    <div class="stage">
      <!-- 主要角色 - 現在都使用圓形相框 -->
      <div class="character" id="basketball-boy">
        <div class="character-frame">
          <img src="images/boy.png" alt="籃球男生">
        </div>
      </div>
      
      <div class="character" id="curly-girl">
        <div class="character-frame">
          <img src="images/girl.png" alt="捲髮女生">
        </div>
      </div>
      
      <div class="character" id="teddy-bear">
        <div class="character-frame">
          <img src="images/bear.png" alt="熊玩偶">
        </div>
      </div>
      
      <div class="character" id="otter">
        <div class="character-frame">
          <img src="images/otter.png" alt="海獺">
        </div>
      </div>
      
      <div class="character" id="golden-retriever">
        <div class="character-frame">
          <img src="images/realCAT.png" alt="黃金獵犬">
        </div>
      </div>
      
      <div class="character" id="british-cat">
        <div class="character-frame">
          <img src="images/realDOG.png" alt="英國短毛貓">
        </div>
      </div>
      
      <!-- 蛋糕 -->
      <div class="cake" id="birthday-cake">
        <div class="cake-frame">
          <img src="images/cake.png" alt="生日蛋糕">
        </div>
      </div>
      
      <!-- 對話框 -->
      <div class="dialog" id="character-dialog"></div>
      
      <!-- 氣球裝飾 -->
      <div class="balloon" style="left: 10%; top: 15%;">
        <div class="balloon-frame">
          <img src="images/trex.png" alt="氣球">
        </div>
      </div>
      <div class="balloon" style="left: 85%; top: 20%; animation-delay: 1s;">
        <div class="balloon-frame">
          <img src="images/ballroomyellow.png" alt="氣球">
        </div>
      </div>
      <div class="balloon" style="left: 20%; top: 10%; animation-delay: 2s;">
        <div class="balloon-frame">
          <img src="images/ballroom.png" alt="氣球">
        </div>
      </div>
      <div class="balloon" style="left: 75%; top: 15%; animation-delay: 3s;">
        <div class="balloon-frame">
          <img src="images/happybirthday.png" alt="氣球">
        </div>
      </div>
      
      <!-- 訊息板 -->
      <div class="message-board" id="message-display"></div>
      
      <!-- 音樂控制 -->
      <audio id="bgMusic" loop>
        <source src="music/bg.m4a" type="audio/mp4">
      </audio>
      <button id="musicButton" class="btn">播放音樂</button>
      </div>
    </div>
  </div>
  
  <!-- 照片集模態視窗 -->
  <div class="photo-modal" id="photo-gallery">
    <div class="modal-content">
      <div class="modal-header">
        <h2>美好回憶</h2>
        <span class="close-button" id="close-gallery">&times;</span>
      </div>
      <div class="photo-instructions">
        <p>✨2024-2025 ECPO走跳世界的蹤跡✨</p>
      </div>
      <div class="gallery">
        <div class="photo">
          <img src="C:\Users\Hsiao-Po Ku\Downloads\411\ecpot3.jpg" alt="照片 1">
        </div>
        <div class="photo">
          <img src="C:\Users\Hsiao-Po Ku\Downloads\411\Tecpo6.jpg" alt="照片 2">
        </div>
        <div class="photo">
          <img src="C:\Users\Hsiao-Po Ku\Downloads\411\Tecpo3.jpg" alt="照片 3">
        </div>
        <div class="photo">
          <img src="C:\Users\Hsiao-Po Ku\Downloads\411\ecpog3.jpg" alt="照片 4">
        </div>
        <div class="photo">
          <img src="C:\Users\Hsiao-Po Ku\Downloads\411\Tecpo7.jpg" alt="照片 5">
        </div>
        <div class="photo">
          <img src="C:\Users\Hsiao-Po Ku\Downloads\411\ecpot6.jpg" alt="照片 6">
        </div>
        <div class="photo">
          <img src="C:\Users\Hsiao-Po Ku\Downloads\411\Tecpo2.jpg" alt="照片 7">
        </div>
        <div class="photo">
          <img src="C:\Users\Hsiao-Po Ku\Downloads\411\Tecpo1.jpg" alt="照片 8">
        </div>
      </div>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 獲取元素
      const basketballBoy = document.getElementById('basketball-boy');
      const curlyGirl = document.getElementById('curly-girl');
      const teddyBear = document.getElementById('teddy-bear');
      const otter = document.getElementById('otter');
      const goldenRetriever = document.getElementById('golden-retriever');
      const britishCat = document.getElementById('british-cat');
      const cake = document.getElementById('birthday-cake');
      const dialog = document.getElementById('character-dialog');
      const photoGallery = document.getElementById('photo-gallery');
      const closeGallery = document.getElementById('close-gallery');
      const messageDisplay = document.getElementById('message-display');
      const musicButton = document.getElementById('music-button');
      
      // 角色資訊與對話
      const characters = [
        {
          element: basketballBoy,
          name: '籃球男生',
          messages: [
            '今天是我的生日！',
            '我是大狗勾！',
            '我是暴龍🦖!'
          ]
        },
        {
          element: curlyGirl,
          name: '捲髮女生',
          messages: [
            '生日快樂！玄中是大巨巨！',
            '每天都要吃飽飽睡飽飽！',
            'Netto！'
          ]
        },
        {
          element: teddyBear,
          name: '熊玩偶',
          messages: [
            '白胖胖愛你！',
            '生日快樂！抱抱!',
            '我最近喜歡睡在地上'
          ]
        },
        {
          element: otter,
          name: '海獺',
          messages: [
            '小小波帶了漂亮的貝殼祝福你！',
            '生日快樂！要記得抱抱我！',
            '祝我們的生活像海洋一樣廣闊精彩！🌊'
          ]
        },
        {
          element: goldenRetriever,
          name: '黃金獵犬',
          messages: [
            '汪汪！生日快樂！',
            '搖尾巴慶祝你的特別日子！',
            '可以分我一塊蛋糕嗎？汪！🥹'
          ]
        },
        {
          element: britishCat,
          name: '英國短毛貓',
          messages: [
            '喵 😻🧡',
            '緲 緲 喵 緲 喵 喵~🎂',
            '喵 喵喵 喵 喵喵😼🐝'
          ]
        }
      ];
      
      // 生日祝福語
      const birthdayWishes = [
        '玄中寶貝24歲生日快樂！✨',
        '你和小波統治世界856萬年了！',
        '我要吃蛋糕🎂👩！',
        '要唱生日快樂歌!還要吹蠟燭🕯️!',
        '祝我的寶貝生日快樂，願你所有的願望都能實現🥳'
      ];
      
      // 顯示角色對話
      function showDialog(character, message) {
        const charRect = character.element.getBoundingClientRect();
        const sceneRect = document.querySelector('.scene').getBoundingClientRect();
        
        dialog.textContent = message;
        dialog.style.opacity = '1';
        dialog.style.transform = 'translateY(0)';
        
        // 相對於場景定位對話框
        const leftPos = charRect.left - sceneRect.left + (charRect.width / 2) - (dialog.offsetWidth / 2);
        const topPos = charRect.top - sceneRect.top - dialog.offsetHeight - 10;
        
        dialog.style.left = `${Math.max(10, Math.min(sceneRect.width - dialog.offsetWidth - 10, leftPos))}px`;
        dialog.style.top = `${Math.max(10, topPos)}px`;
        
        // 3秒後隱藏對話框
        setTimeout(() => {
          dialog.style.opacity = '0';
          dialog.style.transform = 'translateY(10px)';
        }, 3000);
      }
      
      // 隨機選擇一個訊息
      function getRandomMessage(messages) {
        return messages[Math.floor(Math.random() * messages.length)];
      }

     // 創建愛心效果
      function createHearts(e) {
        const numHearts = Math.floor(Math.random() * 5) + 5;
        const container = document.getElementById('container');
      
        for (let i = 0; i < numHearts; i++) {
          const heart = document.createElement('div');
          heart.className = 'heart';
          heart.innerHTML = '❤️';
          heart.style.left = (e.clientX - container.getBoundingClientRect().left) + 'px';
          heart.style.top = (e.clientY - container.getBoundingClientRect().top) + 'px';
          container.appendChild(heart);
        }
      
        // 播放音樂效果（這裡用視覺效果代替）
        document.addEventListener('DOMContentLoaded', function() {
          const musicButton = document.getElementById('musicButton');
          const bgMusic = document.getElementById('bgMusic');
          let isPlaying = false;

          musicButton.addEventListener('click', () => {
            if (isPlaying) {
              bgMusic.pause();
              musicButton.textContent = '播放音樂';
              isPlaying = false;
            } else {
              bgMusic.play()
              .then(() => {
                musicButton.textContent = '暫停音樂';
                isPlaying = true;
              })
              .catch(error => {
                console.error('音樂播放失敗:', error);
                alert('音樂播放失敗，請確認檔案路徑是否正確');
              });
            }
          });
        });

  
        for (let i = 0; i < 20; i++) {
          const note = document.createElement('div');
          note.textContent = musicNotes[Math.floor(Math.random() * musicNotes.length)];
          note.style.position = 'absolute';
          note.style.fontSize = `${Math.random() * 20 + 15}px`;
          note.style.left = `${Math.random() * window.innerWidth}px`;
          note.style.top = `${window.innerHeight}px`;
          note.style.opacity = 1;
    
          document.body.appendChild(note);
    
         // 讓音符上升並消失
         const rise = () => {
           const top = parseFloat(note.style.top);
           const newTop = top - 3;
           const opacity = parseFloat(note.style.opacity);
           const newOpacity = top < window.innerHeight - 200 ? opacity - 0.01 : opacity;
      
           note.style.top = `${newTop}px`;
           note.style.left = `${parseFloat(note.style.left) + (Math.random() * 2 - 1)}px`;
           note.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
           note.style.opacity = newOpacity;
      
           if (newOpacity > 0 && newTop > 0) {
            requestAnimationFrame(rise);
          } else {
            note.remove();
          }
        };
    
      // 延遲開始上升動畫（每個音符有不同的延遲）
          setTimeout(() => {
            requestAnimationFrame(rise);
          }, Math.random() * 5000);
        }
      }
      // 開始跳舞動畫
       function startDancing(element) {
        element.classList.add('dancing');
        setTimeout(() => {
          element.classList.remove('dancing');
        }, 2000);
      }

      // 蛋糕點擊效果
       function setupCake() {
        const cake = document.getElementById('cake');
        const container = document.getElementById('container');
        
        cake.addEventListener('click', () => {
        
            // 創建煙花效果
            createFireworks();
        
            // 顯示生日祝福
            showBirthdayMessage();
        
          // 點擊蛋糕時也產生音符效果
          const event = {
            clientX: cake.getBoundingClientRect().left + cake.offsetWidth / 2,
            clientY: cake.getBoundingClientRect().top + cake.offsetHeight / 2
          };
          createHearts(event);
        });
      }

      // 創建煙花效果
        function createFireworks() {
            const container = document.getElementById('container');
            const colors = ['#FF5252', '#FF4081', '#E040FB', '#7C4DFF', '#536DFE', '#448AFF', '#40C4FF', '#18FFFF', '#64FFDA', '#69F0AE', '#B2FF59', '#EEFF41', '#FFFF00', '#FFD740', '#FFAB40', '#FF6E40'];
            for (let i = 0; i < 100; i++) {
              const confetti = document.createElement('div');
              confetti.className = 'confetti';
              confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
              confetti.style.left = (Math.random() * 100) + '%';
              confetti.style.top = (Math.random() * 100) + '%';
              container.appendChild(confetti);
        
              // 動畫
              const angle = Math.random() * Math.PI * 2;
              const distance = Math.random() * 300 + 50;
              const duration = Math.random() * 2 + 1;
        
              confetti.animate([
                { 
                    transform: 'translate(0, 0) rotate(0deg) scale(0)',
                    opacity: 0
                },
                {
                    transform: `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) rotate(${Math.random() * 360}deg) scale(${Math.random() * 2 + 0.5})`,
                    opacity: 1
                },
                {
                    transform: `translate(${Math.cos(angle) * (distance + 50)}px, ${Math.sin(angle) * (distance + 100)}px) rotate(${Math.random() * 720}deg) scale(0)`,
                    opacity: 0
                }
            ], {
                duration: duration * 1000,
                easing: 'cubic-bezier(0.1, 0.8, 0.2, 1)',
                fill: 'forwards'
            });
        
            // 動畫結束後移除
            setTimeout(() => {
              confetti.remove();
            }, duration * 1000);
          }
        }
    
    
         // 顯示生日祝福
        function showBirthdayMessage() {
            const container = document.getElementById('container');
            const message = document.createElement('div');
            message.className = 'surprise';
            message.style.position = 'absolute';
            message.style.top = '40%';
            message.style.left = '50%';
            message.style.transform = 'translate(-50%, -50%)';
            message.style.fontSize = '36px';
            message.style.fontWeight = 'bold';
            message.style.color = '#FF6B6B';
            message.style.textShadow = '0 0 10px #FFF, 0 0 20px #FFF, 0 0 30px #FF6B6B';
            message.style.textAlign = 'center';
            message.style.whiteSpace = 'nowrap';
            message.style.zIndex = '100';
            message.innerHTML = '生日快樂！親愛的男友<br>4月11日';
            container.appendChild(message);
    
            // 顯示動畫
            message.animate([
                { transform: 'translate(-50%, -50%) scale(0)', opacity: 0 },
                { transform: 'translate(-50%, -50%) scale(1.2)', opacity: 1 },
                { transform: 'translate(-50%, -50%) scale(1)', opacity: 1 }
            ], {
                duration: 1000,
                easing: 'cubic-bezier(0.1, 0.8, 0.2, 1)',
                fill: 'forwards'
            });
    
            // 3秒後淡出
            setTimeout(() => {
               message.animate([
                   { opacity: 1 },
                   { opacity: 0 }
               ], {
                   duration: 1000,
                   fill: 'forwards'
               });
        
              setTimeout(() => {
                   message.remove();
              }, 1000);
          }, 3000);
        }
      // 創建紙屑效果
      function createConfetti() {
        const colors = ['#ff7043', '#42a5f5', '#66bb6a', '#ffca28', '#ab47bc'];
        const confettiCount = 50;
        const scene = document.querySelector('.scene');
        
        for (let i = 0; i < confettiCount; i++) {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          
          // 隨機設定紙屑的形狀和顏色
          const randomColor = colors[Math.floor(Math.random() * colors.length)];
          confetti.style.backgroundColor = randomColor;
          
          // 隨機形狀：矩形或圓形
          if (Math.random() > 0.5) {
            confetti.style.borderRadius = '50%';
          }
          
          // 初始位置
          confetti.style.left = `${Math.random() * 100}%`;
          confetti.style.top = '0';
          
          // 添加到場景
          scene.appendChild(confetti);
          
          // 紙屑飄落動畫
          animateConfetti(confetti);
        }
      }
      
      // 紙屑飄落動畫
      function animateConfetti(confetti) {
        const duration = 3 + Math.random() * 3;
        const sceneHeight = document.querySelector('.scene').offsetHeight;
        
        confetti.style.transition = `top ${duration}s linear, left ${duration}s ease-in-out, transform ${duration/4}s linear`;
        
        // 隨機旋轉
        confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
        
        setTimeout(() => {
          confetti.style.top = `${sceneHeight}px`;
          confetti.style.left = `${parseFloat(confetti.style.left) + (Math.random() * 40 - 20)}%`;
          confetti.style.transform = `rotate(${Math.random() * 360 + 180}deg)`;
        }, 50);
        
        // 動畫結束後移除
        setTimeout(() => {
          confetti.remove();
        }, duration * 1000);
      }
      
      // 設置角色互動
      characters.forEach(character => {
        // 點擊角色顯示對話
        character.element.addEventListener('click', () => {
          showDialog(character, getRandomMessage(character.messages));
        });
        
        // 為角色添加隨機移動
        const randomMove = () => {
          const stage = document.querySelector('.stage');
          const stageWidth = stage.offsetWidth;
          const stageHeight = stage.offsetHeight;
          const charWidth = character.element.offsetWidth;
          const charHeight = character.element.offsetHeight;
          
          // 確保在界面範圍內
          const newX = Math.max(10, Math.min(stageWidth - charWidth - 10, Math.random() * stageWidth));
          const newY = Math.max(10, Math.min(stageHeight - charHeight - 50, 100 + Math.random() * (stageHeight - 200)));
          
          // 使用CSS轉換而不是直接改變位置
          character.element.style.transition = 'left 2s ease, top 2s ease';
          character.element.style.left = `${newX}px`;
          character.element.style.top = `${newY}px`;
        };
        
        // 設置隨機位置
        setTimeout(() => randomMove(), 1000);
        
        // 每隔一段時間隨機移動
        setInterval(randomMove, 5000 + Math.random() * 5000);
      });
      
      // 角色隨機互動
      function randomInteraction() {
        const randomIndex1 = Math.floor(Math.random() * characters.length);
        let randomIndex2 = Math.floor(Math.random() * characters.length);
        // 確保不是同一個角色
        while(randomIndex2 === randomIndex1) {
          randomIndex2 = Math.floor(Math.random() * characters.length);
        }
        
        const char1 = characters[randomIndex1];
        const char2 = characters[randomIndex2];
        
        // 讓兩個角色靠近
        const moveNear = () => {
          const stage = document.querySelector('.stage');
          const midX = Math.random() * (stage.offsetWidth - 200) + 100;
          const midY = Math.random() * (stage.offsetHeight - 300) + 150;
          
          char1.element.style.transition = 'left 1.5s ease, top 1.5s ease';
          char2.element.style.transition = 'left 1.5s ease, top 1.5s ease';
          
          char1.element.style.left = `${midX - 70}px`;
          char1.element.style.top = `${midY}px`;
          
          char2.element.style.left = `${midX + 70}px`;
          char2.element.style.top = `${midY}px`;
        };
        
        moveNear();
        
        // 角色互動後顯示對話
        setTimeout(() => {
          showDialog(char1, getRandomMessage(char1.messages));
        }, 2000);
        
        setTimeout(() => {
          showDialog(char2, getRandomMessage(char2.messages));
        }, 5000);
      }
      
      // 設置定時互動
      setInterval(randomInteraction, 15000);
      
      // 蛋糕點擊效果
      cake.addEventListener('click', () => {
        createConfetti();
        const wish = getRandomMessage(birthdayWishes);
        messageDisplay.textContent = wish;
        
        // 顯示訊息3秒後清除
        setTimeout(() => {
          messageDisplay.textContent = '';
        }, 3000);
        
        // 顯示照片集
        setTimeout(() => {
          photoGallery.style.display = 'block';
        }, 1000);
      });
      
      // 關閉照片集
      closeGallery.addEventListener('click', () => {
        photoGallery.style.display = 'none';
      });
      
      // 點擊照片集背景關閉
      photoGallery.addEventListener('click', (e) => {
        if (e.target === photoGallery) {
          photoGallery.style.display = 'none';
        }
      });
      
      // 音樂按鈕功能（模擬）
      musicButton.addEventListener('click', () => {
        // 實際應用中可以在這裡添加音樂播放功能
        alert('這裡可以添加背景音樂功能！');
      });
      
      // 初始消息顯示
      setTimeout(() => {
        messageDisplay.textContent = '點擊角色和蛋糕來互動！';
        
        setTimeout(() => {
          messageDisplay.textContent = '';
        }, 4000);
      }, 1000);
    });
  </script>
</body>
</html>
